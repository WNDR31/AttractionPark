<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{attraction.name}} - Detalles</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0-alpha1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/2.7.1/css/lightgallery.min.css">
    <link rel="stylesheet" href="/menu.css"> 
</head>
<body>
<!-- Navegation bar -->
<nav id="navegation-principal" class="navbar navbar-expand-lg fixed-top">
    <div class="container-fluid">
        <a id="parque" href="PaginaPrincipal.html">
            <img src="Imagenes/logo.jpg" alt="Logo de LagoonLand" width="80" height="80" class="d-inline-block align-top">
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#menu-navegation" aria-controls="menu-navegation" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="menu-navegation">
            <ul id="menu-navegation" class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item"><a class="nav-link" href="/PaginaPrincipal.html">HOME</a></li>
                <li class="nav-item"><a class="nav-link" href="http://localhost:8080/planifica-tu-visita">PLANIFICA TU VISITA</a></li>
                <li class="nav-item"><a class="nav-link" href="http://localhost:8080/attractionsgalery">DESCUBRE EL PARQUE</a></li>
                <li class="nav-item"><a class="nav-link" href="#footer">HORARIOS</a></li>
                <li class="nav-item"><a class="nav-link highlight-tickets" href="/Compra.html">COMPRA TUS TICKETS</a></li>
            </ul>
        </div>
    </div>
</nav>
<!-- Header with breadcrumb -->
<div class="header-detail">
    <div class="container">
        <h1><i class="fas fa-{{#attraction.type.name}}theater-masks{{/attraction.type.name}}"></i> {{attraction.name}}</h1>
    </div>
</div>

<!-- Floating map button -->
<a href="http://localhost:8080/map" class="map-button">
    <i class="fas fa-map-marked-alt"></i>
    <span class="d-none d-sm-inline">Ver Mapa</span>
</a>

<div class="container">
    <!-- Main detail card -->
    <div class="attraction-detail-card">
        <div class="detail-header">
            <img src="/Imagenes/{{attraction.imageUrl1}}" alt="{{attraction.name}}" class="main-image" 
                 onerror="this.onerror=null;this.src='https://via.placeholder.com/800x400?text=Imagen+no+disponible';">
            
            {{#attraction.imageUrl2}}
            <div class="gallery-thumbnails">
                <img src="/Imagenes/{{attraction.imageUrl1}}" alt="{{attraction.name}}" class="thumbnail" 
                     onclick="changeMainImage(this.src)" 
                     onerror="this.onerror=null;this.src='https://via.placeholder.com/80x60?text=Imagen+1';">
                <img src="/Imagenes/{{attraction.imageUrl2}}" alt="{{attraction.name}}" class="thumbnail" 
                     onclick="changeMainImage(this.src)" 
                     onerror="this.onerror=null;this.src='https://via.placeholder.com/80x60?text=Imagen+2';">
                {{#attraction.imageUrl3}}
                <img src="/Imagenes/{{attraction.imageUrl3}}" alt="{{attraction.name}}" class="thumbnail" 
                     onclick="changeMainImage(this.src)" 
                     onerror="this.onerror=null;this.src='https://via.placeholder.com/80x60?text=Imagen+3';">
                {{/attraction.imageUrl3}}
            </div>
            {{/attraction.imageUrl2}}
        </div>
        
        <div class="detail-body">
            <h2 class="detail-title">{{attraction.name}}</h2>
            
            <div class="detail-meta">
                {{#attraction.type.name}}
                <div class="meta-item">
                    <i class="fas fa-tag"></i> {{attraction.type.name}}
                </div>
                {{/attraction.type.name}}
                {{#attraction.intensity.name}}
                <div class="meta-item">
                    <i class="fas fa-bolt"></i> {{attraction.intensity.name}}
                </div>
                {{/attraction.intensity.name}}
                {{#attraction.zone.name}}
                <div class="meta-item">
                    <i class="fas fa-map-marker-alt"></i> {{attraction.zone.name}}
                </div>
                {{/attraction.zone.name}}
                {{#attraction.minHeight}}
                <div class="meta-item">
                    <i class="fas fa-ruler-vertical"></i> Altura mínima: {{attraction.minHeight}} ''
                </div>
                {{/attraction.minHeight}}
            </div>
            
            <div class="detail-section">
                <h3 class="section-title"><i class="fas fa-align-left"></i> Descripción</h3>
                <p>{{attraction.description}}</p>
            </div>
            
            <div class="detail-section">
                <h3 class="section-title"><i class="fas fa-info-circle"></i> Especificaciones</h3>
                <div class="specs-grid">
                    {{#attraction.height}}
                    <div class="spec-item">
                        <div class="spec-label">Altura</div>
                        <div class="spec-value">{{attraction.height}} ft</div>
                    </div>
                    {{/attraction.height}}
                    
                    {{#attraction.duration}}
                    <div class="spec-item">
                        <div class="spec-label">Duración</div>
                        <div class="spec-value">{{attraction.duration}} segundos</div>
                    </div>
                    {{/attraction.duration}}
                    
                    {{#attraction.speed}}
                    <div class="spec-item">
                        <div class="spec-label">Velocidad máxima</div>
                        <div class="spec-value">{{attraction.speed}} mph</div>
                    </div>
                    {{/attraction.speed}}
                    
                    {{#attraction.line}}
                    <div class="spec-item">
                        <div class="spec-label">Tiempo de espera</div>
                        <div class="spec-value">
                            <div class="wait-time-container">
                                <span class="wait-time-value">{{attraction.line}}</span>
                                <span class="wait-time-unit">minutos</span>
                                <div class="wait-time-animation">
                                    <div class="pulse-dot dot-1"></div>
                                    <div class="pulse-dot dot-2"></div>
                                    <div class="pulse-dot dot-3"></div>
                                </div>
                                <span class="trend-indicator trend-stable"><i class="fas fa-equals"></i></span>
                            </div>
                        </div>
                    </div>
                    {{/attraction.line}}
                </div>
            </div>
            
            {{#attraction.videoUrl}}
            <div class="detail-section">
                <h3 class="section-title"><i class="fas fa-video"></i> Video</h3>
                <div class="video-container">
                    <iframe src="{{attraction.videoUrl}}" frameborder="0" allowfullscreen></iframe>
                </div>
            </div>
            {{/attraction.videoUrl}}
            
            <a href="/attractionsgalery" class="btn btn-back">
                <i class="fas fa-arrow-left"></i> Volver a la galería
            </a>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0-alpha1/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/2.7.1/lightgallery.min.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Change main image when clicking on thumbnails
        window.changeMainImage = function(newSrc) {
            document.querySelector('.main-image').src = newSrc;
        };
        
        // Initialize lightgallery if there are multiple images
        {{#attraction.imageUrl2}}
        const gallery = document.querySelector('.gallery-thumbnails');
        gallery.addEventListener('click', function(e) {
            if(e.target.tagName === 'IMG') {
                const lightGallery = window.lightGallery(gallery, {
                    dynamic: true,
                    dynamicEl: [
                        {src: '/Imagenes/{{attraction.imageUrl1}}', thumb: '/Imagenes/{{attraction.imageUrl1}}'},
                        {src: '/Imagenes/{{attraction.imageUrl2}}', thumb: '/Imagenes/{{attraction.imageUrl2}}'},
                        {{#attraction.imageUrl3}}
                        {src: '/Imagenes/{{attraction.imageUrl3}}', thumb: '/Imagenes/{{attraction.imageUrl3}}'},
                        {{/attraction.imageUrl3}}
                    ],
                    download: false,
                    zoom: true
                });
                lightGallery.openGallery(Array.from(gallery.children).indexOf(e.target));
            }
        });
        {{/attraction.imageUrl2}}

        // Function to simulate changes in waiting time
        function simulateLiveWaitTime() {
            const waitTimeElement = document.querySelector('.wait-time-value');
            const trendIndicator = document.querySelector('.trend-indicator');
            if (!waitTimeElement || !trendIndicator) return;
            
            // Initial value from the database
            let currentTime = parseInt(waitTimeElement.textContent);
            let lastChange = 0;
            
            // Update every 1-2 minutes (to simulate)
            setInterval(() => {
                // Generate a random change (-5 to +10 minutes)
                const change = Math.floor(Math.random() * 16) - 5;
                let newTime = currentTime + change;
                
                // Keep within reasonable limits (5-120 minutes)
                newTime = Math.max(5, Math.min(newTime, 120));
                
                // Only update if there is a change
                if (newTime !== currentTime) {
                    lastChange = newTime - currentTime;
                    currentTime = newTime;
                    
                    // Update trend indicator
                    updateTrendIndicator(lastChange);
                    
                    // Apply animation
                    waitTimeElement.classList.add('wait-time-change');
                    setTimeout(() => {
                        waitTimeElement.textContent = newTime;
                        waitTimeElement.classList.remove('wait-time-change');
                    }, 250);
                    
                    // Change color according to the trend
                    if (lastChange > 0) {
                        waitTimeElement.style.color = '#e74c3c'; // Red - increasing
                    } else if (lastChange < 0) {
                        waitTimeElement.style.color = '#2ecc71'; // Green - decreasing
                    }
                    
                    // Return to original color after 2 seconds
                    setTimeout(() => {
                        waitTimeElement.style.color = 'var(--secondary-color)';
                    }, 2000);
                }
            }, 60000); // Update every minute (adjustable)
        }

        // Function to update the trend indicator
        function updateTrendIndicator(change) {
            const trendIndicator = document.querySelector('.trend-indicator');
            if (!trendIndicator) return;
            
            // Clear previous classes
            trendIndicator.classList.remove('trend-up', 'trend-down', 'trend-stable');
            
            // Determine new trend
            if (change > 0) {
                trendIndicator.classList.add('trend-up');
                trendIndicator.innerHTML = '<i class="fas fa-arrow-up"></i>';
            } else if (change < 0) {
                trendIndicator.classList.add('trend-down');
                trendIndicator.innerHTML = '<i class="fas fa-arrow-down"></i>';
            } else {
                trendIndicator.classList.add('trend-stable');
                trendIndicator.innerHTML = '<i class="fas fa-equals"></i>';
            }
            
            // Animation
            trendIndicator.style.transform = 'scale(1.5)';
            setTimeout(() => {
                trendIndicator.style.transform = 'scale(1)';
            }, 300);
        }

        simulateLiveWaitTime();
    });
</script>
    <footer id="footer">
      <div class="container-footer">
        <div class="footer-section footer-contacto">
          <h3>Contacto</h3>
          <p>Correo: contacto@parqueLagoonLand.com</p>
          <p>Teléfono: +34 123 456 789</p>
        </div>
        <div class="footer-section footer-horario"> 
          <h3>Horarios</h3>
          <p>Lunes a Viernes: 10:00 - 20:00</p>
          <p>Sábados y Domingos: 10:00 - 22:00</p>
        </div>
        <div class="footer-section"> 
          <h3>Calendario</h3>
          <iframe src="https://calendar.google.com/calendar/embed?wkst=1&ctz=Europe%2FParis&showPrint=0&showTitle=0&showCalendars=0&showTz=0&mode=MONTH&src=ZXMuc3BhaW4jaG9saWRheUBncm91cC52LmNhbGVuZGFyLmdvb2dsZS5jb20&color=%23F09300" style="border-width:0" width="500" height="400" frameborder="0" scrolling="no"></iframe>
        </div>
      </div>
      <p class="footer-copyright">© 2025 LagoonLand. Todos los derechos reservados.</p>
    </footer>
</body>
</html>